// console.log('work')
// находим элемент на странице
// constants

const form = document.querySelector('#form');
const taskInput = document.querySelector('#taskInput');
// console.log(taskInput) //<input type="text" className="form-control" id="taskInput" placeholder="Текст задачи" required>
const tasksList = document.querySelector('#tasksList');
const emptyList = document.querySelector('#emptyList')
const addTask = (event) => {
    //  нужно отменить перезагрузку страницы, event записывается в скобки функции и вызывается метод
    // Отменяем отправку формы
    event.preventDefault(); // этот метод отменяет стандартную перезагрузку страницы.
    // console.log('submit')//
    //  Достаём текст задачи из поля ввода
    const taskText = taskInput.value
    // console.log(taskText) //  выводит текст из поля ввода

    const taskHTML = `
         <li class="list-group-item d-flex justify-content-between task-item">
            <span class="task-title">${taskText}</span>
            <div class="task-item__buttons">
                <button type="button" data-action="done" class="btn-action">
                     <img src="./img/tick.svg" alt="Done" width="18" height="18">
                 </button>
                <button type="button" data-action="delete" class="btn-action">
                    <img src="./img/cross.svg" alt="Done" width="18" height="18">
                </button>
            </div>
        </li> `
    // console.log(taskHTML) //  проверка вывода с названием названия с помощью интерполяции  ${taskText}

    //  Добавляем задачу на страницу
    tasksList.insertAdjacentHTML('beforeend', taskHTML);


    taskInput.value = ''; //  для очистки поля ввода после добавления списка дел, присваиваем ему пустую строку

    // оставляем фокус на поле ввода  input
    taskInput.focus(); //  теперь после очистки поля фокус будет перемещаться на поле ввода  input

    //  скрывает emptyList, сначала проверяем нет ли задач, если есть скрываем
    if (tasksList.children.length > 1) {
        emptyList.classList.add('none');
    }
    saveHTMLLS()
};
const deleteTask = (event) => {
    //  куда мы кликнули определяем опять параметром  event
    // Проверяем, что клик был НЕ по кнопке delete
    if (event.target.dataset.action !== 'delete') return;

    const parentNode = event.target.closest('.list-group-item');
    // console.log(parentNode); //  проверка правильной работы  работает правильно, указывает нужный тег

    if (confirm('Вы уверены?')) {
        parentNode.remove() //  удаляет после подтверждения удаления во всплывающем окне

        //  проверяем есть ли в списке задач первый элемент с надписью "Список дел пуст"
        if (tasksList.children.length === 1) {
            emptyList.classList.remove('none'); // удаляем класс
        }
    }


    // console.log('del') //  проверка попали ли мы по области
    // console.log(event.target)//  Проверка куда попали.  Видим тот элемент по которому произошёл клик
    /* if (event.target.dataset.action === 'delete') {
        // console.log('delete') //  проверка, что выводится только при попадании на нужную кнопку
        const parentNode = event.target.closest('.list-group-item');
        // console.log(parentNode); //  проверка правильной работы  работает правильно, указывает нужный тег

        if (confirm('Вы уверены?')) {
            parentNode.remove() //  удаляет после подтверждения удаления во всплывающем окне

            //  проверяем есть ли в списке задач первый элемент с надписью "Список дел пуст"
            if  (tasksList.children.length === 1){
                emptyList.classList.remove('none'); // удаляем класс
            }
        }

    }*/
    saveHTMLLS()
};

const doneTask = (event) => { //  куда мы кликнули определяем опять параметром  event

    if (event.target.dataset.action !== 'done') return;

    // console.log('done') //  проверка, что выводится только при попадании на нужную кнопку
    const parentNode = event.target.closest('.list-group-item')//  нашли родительский тег  li
    // console.log(parentNode); //  выводит названия тех кнопок на которые нажимаем
    const taskTitle = parentNode.querySelector('.task-title');
    // console.log(taskTitle); //  видим нужный span   в консоле

    // Добавляем этому span нужный класс
    taskTitle.classList.toggle('task-title--done');

    // ======================
    //   Добавляем родительскому parentNode  всему комплексу li  значение выполнено, окрашивая в зелёный цвет из бутстрапа
    parentNode.classList.toggle('list-group-item-success');


// ======================================================
    /*    if (event.target.dataset.action === 'done') {
        // console.log('done') //  проверка, что выводится только при попадании на нужную кнопку
        const parentNode = event.target.closest('.list-group-item')//  нашли родительский тег  li
        // console.log(parentNode); //  выводит названия тех кнопок на которые нажимаем
        const taskTitle = parentNode.querySelector('.task-title');
        // console.log(taskTitle); //  видим нужный span   в консоле

        // Добавляем этому span нужный класс
        taskTitle.classList.toggle('task-title--done');

        // ======================
        //   Добавляем родительскому parentNode  всему комплексу li  значение выполнено, окрашивая в зелёный цвет из бутстрапа
        parentNode.classList.toggle('list-group-item-success')

    }*/
    saveHTMLLS()
};

//  Добавляем задачи. Вызов формы  при прослушивании событий
form.addEventListener('submit', addTask);

// Удаляем задачи при прослушивании событий  области добавленной задачи
tasksList.addEventListener('click', deleteTask);

//  Отмечаем задание как выполненное
tasksList.addEventListener('click', doneTask);


// ========================================

// if (localStorage.getItem('tasksHTML')) {
// tasksList.innerHTML = localStorage.getItem('tasksHTML');
// }
// function saveHTMLLS() {
//     localStorage.setItem('tasksHTML', tasksList.innerHTML)
// };

